<!DOCTYPE html>
<html>
<head>
    <title>Outlook Insights</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1>Outlook Insights</h1>
            <p class="subtitle">Communication Analytics Dashboard</p>
        </div>
        <div class="header-actions">
            <button id="refreshButton" class="btn-icon" title="Refresh Data">
                &#x21bb;
            </button>
            <button id="optionsButton" class="btn-icon" title="Settings">
                &#9881;
            </button>
        </div>
    </div>

    <div class="controls">
        <div class="filter-group">
            <label for="sortBy">Sort By:</label>
            <select id="sortBy">
                <option value="ignored">Most Ignored</option>
                <option value="responseTime">Slowest Response</option>
                <option value="volume">Email Volume</option>
                <option value="name">Name (A-Z)</option>
            </select>
        </div>
    </div>

    <div id="loading" class="hidden">
        <div class="spinner"></div>
        <p>Analyzing emails...</p>
    </div>

    <div id="adminConsent" class="admin-consent-error hidden">
        <h3>Admin Approval Required</h3>
        <p>
            Your organization requires administrator approval to connect new applications.
            Click the button below to generate a pre-filled email to send to your IT administrator.
        </p>
        <button id="requestAdminApproval" class="btn-primary">Request Approval from Admin</button>
    </div>

    <div id="summaryStats" class="summary-stats hidden">
        <div class="stat-card">
            <div class="stat-value" id="totalContacts">0</div>
            <div class="stat-label">Contacts</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="totalEmails">0</div>
            <div class="stat-label">Total Emails</div>
        </div>
        <div class="stat-card highlight">
            <div class="stat-value" id="totalIgnored">0</div>
            <div class="stat-label">Emails Ignored</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="avgResponseTime">-</div>
            <div class="stat-label">Avg Response</div>
        </div>
    </div>

    <div id="statsContainer"></div>

    <div id="emptyState" class="empty-state hidden">
        <h3>No Data Available</h3>
        <p>Click the refresh button to analyze your Outlook inbox.</p>
        <button id="refreshFromEmpty" class="btn-primary">Analyze Emails</button>
    </div>

    <div class="footer">
        <div class="footer-buttons">
            <button id="generateReport" class="btn-report">
                Generate Report
            </button>
            <button id="buyMeACoffee" class="btn-secondary">
                Buy Me a Coffee
            </button>
        </div>
    </div>

    <script src="popup.js"></script>
</body>
</html>